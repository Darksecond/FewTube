<!DOCTYPE html>
<html>

<head>

  <style>
    html,
    body {
      margin: 0;
      padding: 0;
    }

    /* video {
      width: 100%;
      height: auto;
    } */
  </style>
  <link href="https://vjs.zencdn.net/7.10.2/video-js.css" rel="stylesheet" />
  <!-- <link href="https://cdn.jsdelivr.net/npm/videojs-hls-quality-selector@1.1.4/dist/videojs-hls-quality-selector.min.css" rel="stylesheet" /> -->
  <!-- <link href="https://unpkg.com/@silvermine/videojs-quality-selector@1.2.4/dist/css/quality-selector.css" rel="stylesheet"> -->

  <script src="https://vjs.zencdn.net/7.10.2/video.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/videojs-contrib-quality-levels@2.0.9/dist/videojs-contrib-quality-levels.min.js"></script>
  <!-- <script src="https://cdn.jsdelivr.net/npm/videojs-hls-quality-selector@1.1.4/dist/videojs-hls-quality-selector.min.js"></script> -->
  <!-- <script src="https://unpkg.com/@silvermine/videojs-quality-selector@1.2.4/dist/js/silvermine-videojs-quality-selector.min.js"></script> -->
  <script src="/videojs-http-source-selector.min.js"></script>

</head>

<body>
  <video controls preload="auto" id="first" class="video-js vjs-default-skin"></video>


  <script>
    const first = document.querySelector('#first');

    (async () => {
      // let response = await fetch('/api/tX5xCQcHbPE');
      // let json = await response.json();
      // first.src = json.video.url;

      // if (shaka.Player.isBrowserSupported()) {
      //   shaka.polyfill.installAll();
      //   const x = new shaka.Player(first);
      //   x.load('/dashtest.mpd');
      // }

      // const dash = dashjs.MediaPlayer().create();
      // dash.initialize(first, '/dashtest.mpd', true);

      var player = videojs('first', {
        preload: 'auto',
        liveui: true,
        controlBar: {
          children: [
            'playToggle',
            'volumePanel',
            'currentTimeDisplay',
            'timeDivider',
            'durationDisplay',
            'progressControl',
            'remainingTimeDisplay',
            'qualitySelector',
            'fullscreenToggle'
          ]
        },
        html5: {
          vhs: {
            overrideNative: true
          }
        },
      });

      window.player = player;




      player.ready(function () {
        
        player.httpSourceSelector()

        player.src({
          src: '/dashtest.mpd',
          type: 'application/dash+xml'
        });

        player.on("loadedmetadata", () => {
          Array.from(player.qualityLevels()).forEach(level => {
            level.enabled = true;
          });
        });
        
      });

    })();

  </script>

</body>

</html>